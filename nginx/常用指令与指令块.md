# 常用指令与指令块

- `http`

- `server`

- `upstream`

- `location`

这四个模块是常用的模块，一般我们有这四个指令就可以将网站文件通过端口映射出来。

```nginx
# 指令块
http {
        # 指令
        include mime.types;
        upstream feup {
                server 127.0.0.1:3000;
        }
        server {
                listen 80;
                server_name localhost;

                location / {
                    root /var/www/html;
                    index index.html index.htm;
                }
        }
        server {
            listen 3000;
            server_name localhost;

            location / {
                root /var/www/feup;
                index index.html;

                try_files $uri /index.html @router;
            }
        }
        server {
                listen 80;
                server_name feup.kaikeba.com;

                location / {
                        proxy_pass   http://feup;
                        proxy_http_version 1.1;
                        proxy_set_header Upgrade $http_upgrade;
                        proxy_set_header Connection $connection_upgrade;
                }
        }
}
```

上面的配置文件包含了一些最简单并常用的访问配置。分别对应下面三个地址：

```bash
# nginx的默认访问地址，对应/var/www/html目录
http://127.0.0.1

# feup打包后的访问地址，对应/var/www/feup目录，而且做了路由重定向
http://127.0.0.1:3000

# 我们将feup.kaikeba.com映射到了3000端口，接下来做一个本地hosts映射就可以通过这个地址来访问feup了
http://feup.kaikeba.com
```

## 指令块 directiveBlock

后面跟大括号的就是指令块

```nginx
http {

}
```

## 指令 directive

```nginx
include mime.types;
```

指令可以接受多个参数，参数用空格分割。

可以将它看成 js 里的这样

```js
// 伪代码
function directive(feature, ...props) {
  return feature(...props);
}
```
